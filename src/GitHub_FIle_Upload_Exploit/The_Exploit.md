# The Exploit
## Explanation
- GitHub allows users to upload files in the comments under commits or issues.
- There are two issues in this process:
	1. The first one is the URL format
		- `https://www.github.com/{project_user}/{repo_name}/files/{file_id}/{file_name}`
		- This makes it seem as if the file uploaded by the malicious actors are from the repository
	2. The download links are created as soon as the file is added to an unsaved comment. 
		- The files are not deleted from the GitHub CDN even if the comment is not posted.
		- This allows malicious actors to minimize their footprint.


## The Test Repo
![](Attachments/Pasted%20image%2020240617202523.png)
- This account and repository was created for this PoC


## Allowed Filetypes
![](Attachments/Pasted%20image%2020240702022002.png)

## Image
1. Create a new issue.
2. Select "Paste, drop or click to add files".![](Attachments/Pasted%20image%2020240617203343.png)
3. Wait for the file to get uploaded.![](Attachments/Pasted%20image%2020240617203749.png)
4. Copy the permalink and close the page without submitting the issue.
	`https://github.com/fvj-mal-test/Upload_Exploit/assets/173075384/330b5754-1919-44e1-ac05-4726eed11b4e`
5. This link can now be sent to the target.

## ZIP file
- Uploading Mimikatz as a password protected zip file![](Attachments/Pasted%20image%2020240617205415.png)
- Pasting the link will prompt a download  - `https://github.com/user-attachments/files/15873340/Mimikatz.zip` ![](Attachments/Pasted%20image%2020240617205603.png)


